<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>(도커) 도커와 DevOps | 대현’s 개발일지</title>
<meta name="generator" content="Jekyll v4.3.3">
<meta property="og:title" content="(도커) 도커와 DevOps">
<meta name="author" content="Yun Daehyun">
<meta property="og:locale" content="ko">
<meta name="description" content="DevOps &amp; Pipeline DevOps">
<meta property="og:description" content="DevOps &amp; Pipeline DevOps">
<link rel="canonical" href="/jekyll-theme-yat/docker/2024/02/27/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4%EC%99%80-DevOps.html">
<meta property="og:url" content="/jekyll-theme-yat/docker/2024/02/27/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4%EC%99%80-DevOps.html">
<meta property="og:site_name" content="대현’s 개발일지">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-02-27T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="(도커) 도커와 DevOps">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yun Daehyun"},"dateModified":"2024-02-27T00:00:00+00:00","datePublished":"2024-02-27T00:00:00+00:00","description":"DevOps &amp; Pipeline DevOps","headline":"(도커) 도커와 DevOps","mainEntityOfPage":{"@type":"WebPage","@id":"/jekyll-theme-yat/docker/2024/02/27/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4%EC%99%80-DevOps.html"},"url":"/jekyll-theme-yat/docker/2024/02/27/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4%EC%99%80-DevOps.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="icon" href="images/favicon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/jekyll-theme-yat/assets/css/main.css">
  <script src="/jekyll-theme-yat/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/jekyll-theme-yat/feed.xml" title="대현's 개발일지">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/jekyll-theme-yat/">
  <img class="site-favicon" title="대현's 개발일지" src="images/favicon.png" onerror="this.style.display='none'">
  대현's 개발일지
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/jekyll-theme-yat/about.html">ABOUT</a><a class="page-link" href="/jekyll-theme-yat/archives.html">ARCHIVES</a><a class="page-link" href="/jekyll-theme-yat/categories.html">CATEGORIES</a><a class="page-link" href="/jekyll-theme-yat/">HOME</a><a class="page-link" href="/jekyll-theme-yat/tags.html">TAGS</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'ko',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<div id="click-to-top" class="click-to-top">
  <i class="fa fa-arrow-up"></i>
</div>
<script>
  (function () {
    const clickToTop = document.getElementById('click-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        clickToTop.classList.add('show')
      }else {
        clickToTop.classList.remove('show')
      }
    });
    clickToTop.addEventListener('click', () => {
      window.smoothScrollTo(0);
    });
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">(도커) 도커와 DevOps</h1>
  <h2 class="post-subtitle">개발자를 위한 쉬운 도커 (데브위키)</h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2024-02-27T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Feb 27, 2024
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 13 mins</span>
  </p>
<div class="post-tags"><a class="post-tag" href="/jekyll-theme-yat/tags.html#Docker">#Docker</a></div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="devops--pipeline">DevOps &amp; Pipeline</h2>
<h3 id="devops">DevOps</h3>
<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/83f4ead0-130e-4273-b02d-6f3550f873ae" alt="image"></p>

<ul>
  <li>DevOps = Development(개발) + Operations(운영)</li>
  <li>개발과 운영의 거리를 줄인다.</li>
  <li>데브옵스는 애플리케이션과 서비스를 빠른 속도로 제공하기 위한 문화, 철학, 방식, 도구를 모두 포함한다.</li>
  <li>데브옵스는 컨테이너, CI/CD, 자동화, MSA, IaC 등의 개념과 연관이 있다.</li>
  <li>컨테이너는 개발자 간의 개발 환경과 배포환경과의 차이를 줄여 빠르고 안정적인 배포가 가능해진다.</li>
</ul>

<h3 id="cicd-파이프라인">CI/CD 파이프라인</h3>
<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/4a046c1f-9468-48d5-bff6-e40f7fb3e296" alt="image"></p>

<ul>
  <li>파이프라인은 소스코드부터 배포 환경 관리까지의 모든 프로세스를 자동화하는 것을 의미한다.</li>
  <li>CD (Continuous Integration)
    <ul>
      <li>지속적 통합</li>
      <li>배포가능한 아티팩트(Jar/Image)를 빌드하는 단계</li>
      <li>소스코드를 배포 가능한 아티팩트로 만드는 것을 자동화한다.</li>
    </ul>
  </li>
  <li>CD (Continuous Delivery/Deployment)
    <ul>
      <li>지속적 배포</li>
      <li>실제 환경에 아티팩트를 배포하는 단계</li>
      <li>아티팩트를 배포 환경에 배포</li>
    </ul>
  </li>
  <li>이렇게 CD/CD 파이프라인을 구성해서 빌드 및 배포 단계를 자동화하여 운영작업을 편리하게 할 수 있다.</li>
</ul>

<h3 id="github-actions">Github Actions</h3>
<ul>
  <li>Github에 소스코드를 push하면 Github Actions에서 CI/CD 파이프라인을 자동으로 실행시킬 수 있다.</li>
  <li>Github Actions을 사용하여 개발자의 PC나 별도의 빌드용 서버가 없이 파이프라인을 실행할 수 있다.</li>
  <li>프로젝트 폴더 안의 .github/workflows 폴더 안에 yml파일을 구성하여 파이프라인을 실행한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/26492c61-0302-4f9e-a0c0-937a2cd15fd8" alt="image"></p>

<ul>
  <li>실제 진행중인 프로젝트의 workflows폴더 안의 yml 파일이다.</li>
  <li>Github가 이 파일을 자동으로 인식하여 파이프라인을 실행한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/aa8da01b-27ed-4687-8d30-91bfd3aceeb7" alt="image"></p>

<ul>
  <li>Github에서 일정 크기의 러너 서버를 무료로 지원해준다.</li>
  <li>사용자는 러버 서버를 빌려 이 서버 위에서 Github Actions을 통해 워크플로우를 자동으로 실행할 수 있다.</li>
  <li>Github Actions에 문법에 맞게 코드를 작성하면 자동으로 코드를 읽어들여 워크 플로우가 실행된다.</li>
</ul>

<h3 id="github-actions-문법">Github Actions 문법</h3>
<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/fcf2d74e-6fd5-4cc0-89d5-321eb3477fb1" alt="image"></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name:</code>에 워크 플로우의 이름을 지정한다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">on:</code>아래에 트리거를 설정한다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">jobs:</code>아래에 여러 작업으로 나누어진 워크플로우를 작성한다. build-and-push로 설정하여 job을 여러개 지정할 수 있다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">runs-on:</code>에 작업이 실제로 실행될 러너(서버)를 지정한다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">steps:</code>는 각 작업을 나타내고, 여러개 지정할 수 있다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/ef6e2e88-faa0-4247-892d-57953e097c8e" alt="image"></p>

<ul>
  <li>시간 트리거 : 특정 시간을 설정하면 해당 시간에 워크플로우가 자동으로 실행된다.</li>
  <li>푸시 트리거 : 소스코드를 변경하고 Github에 push하면 자동으로 워크 플로우를 실행한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/1ca1e918-fce4-404e-979a-8b839d66d3a9" alt="image"></p>

<ul>
  <li>모든 작업(steps)는 러너에서 실행된다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">steps:</code>아래의 <code class="language-plaintext highlighter-rouge">uses:</code>에 actions/checkout@v2을 사용하면 Github의 소스코드를 러너에 다운받을 수 있다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/6f4c01ed-7478-4567-b48f-7cd33d922485" alt="image"></p>

<ul>
  <li>도커의 buildx 기능을 활성화하면 멀티플랫폼 빌드나 캐싱과 같은 기능을 사용할 수 있다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">steps:</code>아래의 <code class="language-plaintext highlighter-rouge">uses:</code>에 docker/setup-buildx-action@v1을 사용하면 buildx 기능을 사용하여 도커의 기능을 확장한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/e803b180-e2e3-4130-8815-c587282b9f32" alt="image"></p>

<ul>
  <li>도커에 로그인해야지만 이미지를 푸시할 수 있다. 따라서, 도커 로그인 정보를 입력해주어야한다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">steps:</code>아래의 <code class="language-plaintext highlighter-rouge">uses:</code>에 docker/login-action@v1을 사용하면 도커 로그인 명령을 실행한다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">with:</code>아래에 도커의 로그인 정보를 입력한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/7318dd22-7232-4075-9212-2f97359c27d5" alt="image"></p>

<ul>
  <li>Github의 시크릿 기능을 활용하여 시크릿에 입력되어 있는 로그인 정보를 가져와 사용한다.</li>
</ul>

<p><img src="https://github.com/eogus0512/eogus0512.github.io/assets/71585151/7c88c574-2130-4b17-819c-d896ede0637a" alt="image"></p>

<ul>
  <li>build-push-action은 소스코드를 사용해서 이미지를 빌드하고 이미지를 레지스트리에 푸시하는 액션이다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">with:</code>아래에 build-push-action에 필요한 정보를 입력한다.</li>
</ul>

<h3 id="github-actions-실제-활용">Github Actions 실제 활용</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name: CICD

on:
  pull_request:
    branches: [ "develop" ]
    types: [ closed ]

jobs:
  build-and-upload:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - uses: actions/checkout@v4
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Make application.yml
        working-directory: ./backend
        run: |
          cd ./src/main
          mkdir resources
          cd ./resources
          touch ./application.yml
          echo "$" &gt; ./application.yml
        shell: bash

      - name: Grant execution permission for gradle
        working-directory: ./backend
        run: chmod +x gradlew

      - name: Build with Gradle Without test
        working-directory: ./backend
        run: ./gradlew clean build -x test

      - name: Docker build &amp; push
        working-directory: ./backend
        run: |
          docker login -u $ -p $
          docker build -t $/moyeobwa -f Dockerfile .
          docker push $/moyeobwa

      - name: Deploy
        uses: appleboy/ssh-action@master
        with:
          host: $
          username: ubuntu
          key: $
          port: $
          script: |
            docker stop moyeobwa
            docker rm moyeobwa
            docker image rm -f moyeobwa
            docker pull $/moyeobwa
            docker run -d -p 8080:8080 --name moyeobwa $/moyeobwa
</code></pre></div></div>
<ul>
  <li>위 yml파일은 실제 프로젝트에 사용한 워크플로우 이다.</li>
  <li>pull request가 develop 브랜치에서 닫힐 때 워크플로우가 실행된다.</li>
  <li>워크플로우 단계 구성
    <ol>
      <li>Set up JDK 17: Java 개발환경을 설정한다. JDK 17을 사용하고 Temurin 배포를 설치한다.</li>
      <li>Make application.yml: 어플리케이션의 설정 파일인 application.yml을 생성하고 시크릿으로부터 값을 이 파일에 저장한다. ./backend 폴더에서 run아래 명령어가 실행된다.</li>
      <li>Grant execution permission for gradle: Gradle 실행 권한을 부여한다.</li>
      <li>Build with Gradle Without test: Gradle을 사용하여 테스트를 제외하고 빌드한다.</li>
      <li>Docker build &amp; push: Docker 이미지를 빌드하고 Docker 레지스트리에 푸시한다. run 아래에 시크릿에서 받아온 도커 로그인 정보를 입력하고, 해당 레지스트리에 도커파일을 사용하여 이미지를 빌드하고 푸시한다.</li>
      <li>Deploy: SSH를 사용하여 호스트 서버로 접속하여 이전 버전의 컨테이너를 정지하고 삭제한 후, 새로운 Docker 이미지를 풀(pull)하여 컨테이너를 다시 실행한다. with아래에 EC2 서버 주소, 포트 등의 정보를 시크릿에서 받아와 접속하고, script에 입력된 명령어를 통해 EC2서버에 실행되어 있는 이전 컨테이너를 정지 및 삭제하고, 새롭게 생성한 이미지를 풀하여 다시 실행한다.</li>
    </ol>
  </li>
</ul>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/jekyll-theme-yat/docker/2024/02/27/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4-%EC%BB%B4%ED%8F%AC%EC%A6%88.html" title="(도커) 도커 컴포즈">(도커) 도커 컴포즈</a><a class="next" href="/jekyll-theme-yat/oauth2/2024/04/18/(OAuth2-Login)-%EA%B5%AC%EA%B8%80-%EC%86%8C%EC%85%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84-(1)-_-%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC.html" title="(OAuth2 Login) 구글 소셜 로그인 구현 (1) - 동작원리">(OAuth2 Login) 구글 소셜 로그인 구현...</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/jekyll-theme-yat/spring/2023/12/23/(%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC)-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88.html" title="(OAuth2 Login) 구글 소셜 로그인 구현 (1) - 동작원리">(스프링 핵심원리) 스프링 컨테이너</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/docker/2024/02/25/(%EB%8F%84%EC%BB%A4)-%EB%8F%84%EC%BB%A4-%EB%B3%BC%EB%A5%A8.html" title="(OAuth2 Login) 구글 소셜 로그인 구현 (1) - 동작원리">(도커) 도커 볼륨</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/cs/2023/10/11/(%EC%BB%B4%ED%93%A8%ED%84%B0-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC)-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B3%84%EC%B8%B5-_-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8F%89%EB%A9%B4.html" title="(OAuth2 Login) 구글 소셜 로그인 구현 (1) - 동작원리">(컴퓨터 네트워크) 네트워크 계층 - 데이터 평면</a></li>
<li><a class="post-link" href="/jekyll-theme-yat/spring/2024/01/09/(%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC)-%EB%B9%88-%EC%8A%A4%EC%BD%94%ED%94%84.html" title="(OAuth2 Login) 구글 소셜 로그인 구현 (1) - 동작원리">(스프링 핵심원리) 빈 스코프</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jekyll-theme-yat/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>Unpublished Work <span class="copyleft">©</span> 2017-2024 Yun Daehyun</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="https://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/jekyll-theme-yat/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
